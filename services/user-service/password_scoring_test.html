<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Scoring Test</title>
    <link rel="stylesheet" href="/assets/application.css">
</head>
<body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-900 mb-8 text-center">Password Scoring System - Fixed</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Test Cases -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4">Test Cases</h2>
                <div class="space-y-4">
                    <div class="p-3 border rounded">
                        <strong>Very Weak (0-19%):</strong> "123" (0 points)
                    </div>
                    <div class="p-3 border rounded">
                        <strong>Weak (20-39%):</strong> "password" (20 points - only letters)
                    </div>
                    <div class="p-3 border rounded">
                        <strong>Medium (40-59%):</strong> "password123" (40 points - letters + numbers)
                    </div>
                    <div class="p-3 border rounded">
                        <strong>Strong (60-79%):</strong> "Password123!" (80 points - all requirements + length bonus)
                    </div>
                    <div class="p-3 border rounded">
                        <strong>Very Strong (80-100%):</strong> "SecurePass123!" (100 points - all requirements + max length bonus)
                    </div>
                </div>
            </div>
            
            <!-- Scoring System -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4">Scoring System</h2>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between">
                        <span>Length (8-16 chars):</span>
                        <span class="font-mono">20 points</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Contains letters:</span>
                        <span class="font-mono">20 points</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Contains numbers:</span>
                        <span class="font-mono">20 points</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Contains special chars:</span>
                        <span class="font-mono">20 points</span>
                    </div>
                    <hr class="my-2">
                    <div class="flex justify-between">
                        <span>Length bonus (10+ chars):</span>
                        <span class="font-mono">+10 points</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Length bonus (12+ chars):</span>
                        <span class="font-mono">+20 points</span>
                    </div>
                    <hr class="my-2">
                    <div class="flex justify-between font-bold">
                        <span>Maximum score:</span>
                        <span class="font-mono">100 points</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Live Test -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4">Live Test</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password:</label>
                    <input type="text" id="test-password" placeholder="Type a password to test" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <div class="flex justify-between mb-1">
                        <span class="text-sm text-gray-600">Score:</span>
                        <span class="text-sm font-medium" id="score-display">0 points</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="h-2 rounded-full transition-all duration-300 bg-red-500" 
                             style="width: 0%" id="score-bar"></div>
                    </div>
                    <div class="mt-1">
                        <span class="text-sm font-medium" id="strength-display">Very Weak</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div>
                        <strong>Requirements Met:</strong>
                        <ul id="requirements-list" class="mt-1 space-y-1">
                            <li class="text-red-500">❌ Length (8-16 chars)</li>
                            <li class="text-red-500">❌ Contains letters</li>
                            <li class="text-red-500">❌ Contains numbers</li>
                            <li class="text-red-500">❌ Contains special chars</li>
                        </ul>
                    </div>
                    <div>
                        <strong>Score Breakdown:</strong>
                        <ul id="score-breakdown" class="mt-1 space-y-1">
                            <li>Base requirements: 0 points</li>
                            <li>Length bonus: 0 points</li>
                            <li><strong>Total: 0 points</strong></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('test-password').addEventListener('input', function() {
            const password = this.value;
            const result = calculatePasswordStrength(password);
            
            // Update score display
            document.getElementById('score-display').textContent = result.score + ' points';
            document.getElementById('score-bar').style.width = result.score + '%';
            document.getElementById('strength-display').textContent = result.strength;
            
            // Update color
            let color = 'bg-red-500';
            if (result.score >= 80) color = 'bg-green-500';
            else if (result.score >= 60) color = 'bg-blue-500';
            else if (result.score >= 40) color = 'bg-yellow-500';
            else if (result.score >= 20) color = 'bg-orange-500';
            
            document.getElementById('score-bar').className = 'h-2 rounded-full transition-all duration-300 ' + color;
            
            // Update requirements
            const requirements = [
                { name: 'Length (8-16 chars)', met: result.checks.length },
                { name: 'Contains letters', met: result.checks.letter },
                { name: 'Contains numbers', met: result.checks.number },
                { name: 'Contains special chars', met: result.checks.special }
            ];
            
            const requirementsList = document.getElementById('requirements-list');
            requirementsList.innerHTML = requirements.map(req => 
                `<li class="${req.met ? 'text-green-500' : 'text-red-500'}">${req.met ? '✅' : '❌'} ${req.name}</li>`
            ).join('');
            
            // Update score breakdown
            const metRequirements = Object.values(result.checks).filter(check => check).length;
            const baseScore = metRequirements * 20;
            const lengthBonus = result.lengthBonus;
            
            document.getElementById('score-breakdown').innerHTML = `
                <li>Base requirements: ${baseScore} points</li>
                <li>Length bonus: ${lengthBonus} points</li>
                <li><strong>Total: ${result.score} points</strong></li>
            `;
        });
        
        function calculatePasswordStrength(password) {
            if (!password) {
                return {
                    score: 0,
                    strength: 'Very Weak',
                    checks: { length: false, letter: false, number: false, special: false },
                    lengthBonus: 0
                };
            }
            
            const checks = {
                length: password.length >= 8 && password.length <= 16,
                letter: /[a-zA-Z]/.test(password),
                number: /\d/.test(password),
                special: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)
            };
            
            // Count how many requirements are met
            const metRequirements = Object.values(checks).filter(check => check).length;
            
            // Base score: 20 points per requirement met (max 80 points)
            let score = metRequirements * 20;
            
            // Bonus for length (max 20 points)
            let lengthBonus = 0;
            if (password.length >= 12) {
                lengthBonus = 20;
                score += 20;
            } else if (password.length >= 10) {
                lengthBonus = 10;
                score += 10;
            }
            
            score = Math.min(score, 100);
            
            // Determine strength level
            let strength = 'Very Weak';
            if (score >= 80) strength = 'Very Strong';
            else if (score >= 60) strength = 'Strong';
            else if (score >= 40) strength = 'Medium';
            else if (score >= 20) strength = 'Weak';
            
            return {
                score,
                strength,
                checks,
                lengthBonus
            };
        }
    </script>
</body>
</html>
